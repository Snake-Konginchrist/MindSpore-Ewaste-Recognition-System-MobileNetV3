# 图像预处理工具使用说明

## 概述

项目提供了一套完整的图像预处理工具，位于 `image_preprocessing` 目录，用于提高数据集质量和训练效果。

## 工具列表

### 1. 图像重命名工具 (image_renamer.py)

#### 功能
- 批量重命名图像文件为标准格式
- 支持按类别处理
- 提供交互式选择和确认机制

#### 使用方法
```bash
# 直接运行
python image_preprocessing/image_renamer.py

# 通过预处理CLI
python image_preprocessing/preprocess_cli.py rename
```

#### 功能特点
- 自动检测图像文件
- 按类别批量重命名
- 保持文件扩展名
- 生成重命名日志

### 2. 图像验证工具 (image_validator.py)

#### 功能
- 检查并修复损坏或有问题的图像
- 支持移动、删除或修复问题图像
- 生成验证报告

#### 使用方法
```bash
# 直接运行
python image_preprocessing/image_validator.py

# 通过预处理CLI
python image_preprocessing/preprocess_cli.py validate
```

#### 功能特点
- 检测损坏的图像文件
- 验证图像格式和完整性
- 提供修复选项
- 生成详细验证报告

### 3. 图像格式转换工具 (image_converter.py)

#### 功能
- 将图像转换为不同格式（JPG、PNG 等）
- 支持调整图像大小
- 批量处理多个类别

#### 使用方法
```bash
# 直接运行
python image_preprocessing/image_converter.py

# 通过预处理CLI
python image_preprocessing/preprocess_cli.py convert
```

#### 功能特点
- 支持多种输出格式
- 可调整图像尺寸
- 保持图像质量
- 批量处理支持

### 4. 图像分析工具 (image_analyzer.py)

#### 功能
- 生成数据集统计信息和可视化
- 分析图像尺寸、格式、亮度等特性
- 输出分析报告和图表

#### 使用方法
```bash
# 直接运行
python image_preprocessing/image_analyzer.py

# 通过预处理CLI
python image_preprocessing/preprocess_cli.py analyze
```

#### 功能特点
- 统计图像数量分布
- 分析图像尺寸分布
- 检测图像质量问题
- 生成可视化图表

### 5. 预处理命令行界面 (preprocess_cli.py)

#### 功能
- 统一的命令行界面访问所有预处理工具
- 交互式操作指引
- 简化工具使用流程

#### 使用方法
```bash
# 启动交互式界面
python image_preprocessing/preprocess_cli.py

# 直接指定工具
python image_preprocessing/preprocess_cli.py [rename|validate|convert|analyze]
```

#### 功能特点
- 统一的用户界面
- 交互式操作指引
- 支持批量操作
- 错误处理和提示

## 详细使用指南

### 图像重命名

#### 步骤
1. 运行重命名工具
2. 选择要处理的类别目录
3. 确认重命名规则
4. 执行重命名操作

#### 重命名规则
- 格式：`类别名_序号.扩展名`
- 示例：`camera_001.jpg`, `keyboard_002.png`

#### 注意事项
- 重命名前建议备份原始文件
- 确保有足够的磁盘空间
- 检查文件权限

### 图像验证

#### 验证项目
- 文件完整性检查
- 图像格式验证
- 文件大小检查
- 图像可读性测试

#### 处理选项
- **移动**：将问题文件移动到指定目录
- **删除**：直接删除问题文件
- **修复**：尝试修复损坏的文件
- **跳过**：保留原文件

#### 验证报告
- 总文件数量
- 问题文件数量
- 问题类型统计
- 处理结果汇总

### 图像格式转换

#### 支持的格式
- **输入**：JPG, PNG, BMP, TIFF, GIF
- **输出**：JPG, PNG, BMP

#### 转换选项
- 目标格式选择
- 图像质量设置
- 尺寸调整选项
- 批量处理模式

#### 质量设置
- JPG质量：1-100
- PNG压缩级别：0-9
- 保持原始尺寸或指定新尺寸

### 图像分析

#### 分析内容
- 图像数量统计
- 尺寸分布分析
- 格式分布统计
- 文件大小分析
- 亮度分布检测

#### 输出报告
- 文本统计报告
- 可视化图表
- 问题图像列表
- 优化建议

#### 图表类型
- 饼图：格式分布
- 柱状图：尺寸分布
- 直方图：文件大小分布
- 散点图：尺寸vs大小关系

## 高级功能

### 批量处理

#### 并行处理
- 支持多线程处理
- 自动检测CPU核心数
- 可手动指定线程数

#### 进度显示
- 实时进度条
- 处理速度显示
- 剩余时间估算

### 错误处理

#### 异常捕获
- 文件访问错误
- 格式不支持错误
- 内存不足错误
- 权限错误

#### 恢复机制
- 自动重试机制
- 错误日志记录
- 部分失败处理

### 配置选项

#### 全局配置
- 默认输出目录
- 文件命名规则
- 质量设置
- 并行处理参数

#### 工具特定配置
- 重命名规则配置
- 验证标准设置
- 转换参数配置
- 分析选项设置

## 最佳实践

### 数据准备
1. **备份原始数据**：处理前创建完整备份
2. **检查磁盘空间**：确保有足够空间存储处理结果
3. **验证文件权限**：确保有读写权限

### 处理顺序
1. **验证数据**：首先验证图像完整性
2. **分析数据**：了解数据集特征
3. **重命名文件**：统一文件命名
4. **格式转换**：转换为标准格式
5. **最终验证**：确认处理结果

### 质量控制
- 定期检查处理结果
- 验证图像质量
- 保持数据一致性
- 记录处理日志

## 故障排除

### 常见问题

#### 文件访问错误
- 检查文件权限
- 确认文件路径正确
- 检查磁盘空间

#### 格式不支持
- 确认图像格式
- 安装必要的库
- 使用支持的格式

#### 内存不足
- 减少批量大小
- 关闭其他程序
- 使用流式处理

#### 处理速度慢
- 启用并行处理
- 减少图像尺寸
- 优化质量设置

### 调试技巧
- 查看详细日志
- 使用小数据集测试
- 逐步增加处理量
- 监控系统资源

## 扩展开发

### 添加新工具
1. 创建新的工具文件
2. 实现标准接口
3. 添加到CLI界面
4. 更新文档

### 自定义处理
- 修改处理逻辑
- 添加新的验证规则
- 自定义输出格式
- 扩展分析功能 